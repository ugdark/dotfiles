---
name: d-plan-implement
description: "Planのチェックボックスを1つずつ実装 - 実装→ユーザー確認→plan更新の順序厳守"
user-invocable: true
disable-model-invocation: false
---

# チェックボックスを実装

planの「対応状況」にあるチェックボックスを1つずつ実装する。

## 使用場面

Claudeは以下の状況で**自動的にこのスキルを適用**する：

- 「次のタスクに進んで」「このチェックボックスを実装して」と言われた時
- plan確認後に「最初のタスクに進みますか？」に対してOKが返された時

また、`/d-plan-implement` で手動呼び出しも可能。

## 前提

- plan.mdの「対応状況」にチェックボックスが作成済み
- `/d-plan-review` が完了済み

## 実行フロー（6ステップ）

### Step 1: タスク開始

1. 対象チェックボックスの確認（ユーザー指示 or 最初の未完了タスク）
2. plan.mdの読み込み
   - Read: 現在作業中のplan.md
   - 「要望・要件」「前提条件」「対象コード」を再確認
3. 実装内容の理解と方針決定

### Step 2: 実装開始

**重要**: 設計確認は取らず、すぐに実装を開始する。

### Step 3: 実装

1. ファイルの作成・編集
   - プロジェクトのCLAUDE.mdのコーディング規約に従う
2. エラー対応
   - コンパイルエラーが出たら修正
   - 最大3回まで自動リトライ
   - 3回失敗したらユーザーに報告
3. 途中経過の保存
   - コンパイルできない状態でも途中保存OK

### Step 4: 実装内容の報告とユーザー確認（必須停止）

1. 実装内容の簡潔な報告
   - 作成・編集したファイルを列挙
   - 主要な変更内容を1-2行で説明
   - **「実装内容を確認してください。問題なければOKと返答してください」と明示的に伝える**

2. **必ずユーザーの確認を待つ**
   - ユーザーから「OK」「問題ない」「進めて」などの明示的な承認があるまで待機
   - NGの場合は修正してStep 3へ戻る
   - OKの場合のみStep 5へ進む

### Step 5: plan.md更新

**重要**: Step 4でユーザーのOKを受け取った後のみ実行

1. plan.mdへの結果追記
   - Edit: 「## 実装メモ」セクション末尾に追記
   ```markdown
   ### [タスク名] の結果
   - 実装完了：[yyyy-MM-dd]
   - 変更ファイル：
     - [ファイルパス1]
     - [ファイルパス2]
   - 変更点：
     - [変更内容1]
     - [変更内容2]
   - 問題点：[あれば記載、なければ「なし」]
   - 新規タスク：[発見したタスクがあれば記載]
   ```

### Step 6: チェックボックス完了マーク

1. チェックボックスの更新
   - Edit: `- [ ] [タスク名]` → `- [x] [タスク名]`
2. 新規タスクがあれば「## 対応状況」に追加
3. 完了報告
   - 残りのチェックボックス状況を報告
4. **次のタスク確認**
   - 「次のタスクに進みますか？」とユーザーに確認
   - **勝手に次のタスクを開始しない**

## 最重要ルール

- **実装 → ユーザー確認（Step 4） → OK受領 → plan.md更新（Step 5） → チェック更新（Step 6）の順序厳守**
- **Step 4で必ず停止してユーザーの明示的なOKを待つ**
- **ユーザーのOKなしでplan.md更新やチェックボックス更新は絶対禁止**
- 並列実行禁止（1つずつ順番に）
- フォーマット（sbt format等）は全タスク完了後に実行（各タスクでは実行しない）
- 次のタスクに進む際は必ずユーザーに確認する

## planファイルパス

`~/.dotfiles/local/plans/`
